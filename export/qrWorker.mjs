class BitMatrix{constructor(e,o){this.width=o,this.height=e.length/o,this.data=e}static createEmpty(e,o){return new BitMatrix(new Uint8ClampedArray(e*o),e)}get(e,o){return!(e<0||e>=this.width||o<0||o>=this.height)&&!!this.data[o*this.width+e]}set(e,o,r){this.data[o*this.width+e]=r?1:0}setRegion(e,o,r,t,s){for(let c=o;c<o+t;c++)for(let o=e;o<e+r;o++)this.set(o,c,!!s)}}const REGION_SIZE=8,MIN_DYNAMIC_RANGE=24;function numBetween(e,o,r){return e<o?o:e>r?r:e}class Matrix{constructor(e,o,r){this.width=e;const t=e*o;if(r&&r.length!==t)throw new Error("Wrong buffer size");this.data=r||new Uint8ClampedArray(t)}get(e,o){return this.data[o*this.width+e]}set(e,o,r){this.data[o*this.width+e]=r}}function binarize(e,o,r,t,s,c){const d=o*r;if(e.length!==4*d)throw new Error("Malformed data passed to binarizer.");let n,l=0;c&&(n=new Uint8ClampedArray(e.buffer,l,d),l+=d);const a=new Matrix(o,r,n);if(s.useIntegerApproximation)for(let t=0;t<r;t++)for(let r=0;r<o;r++){const c=4*(t*o+r),d=e[c],n=e[c+1],l=e[c+2];a.set(r,t,s.red*d+s.green*n+s.blue*l+128>>8)}else for(let t=0;t<r;t++)for(let r=0;r<o;r++){const c=4*(t*o+r),d=e[c],n=e[c+1],l=e[c+2];a.set(r,t,s.red*d+s.green*n+s.blue*l)}const i=Math.ceil(o/8),B=Math.ceil(r/8),k=i*B;let u;c&&(u=new Uint8ClampedArray(e.buffer,l,k),l+=k);const m=new Matrix(i,B,u);for(let e=0;e<B;e++)for(let o=0;o<i;o++){let r=1/0,t=0;for(let s=0;s<8;s++)for(let c=0;c<8;c++){const d=a.get(8*o+c,8*e+s);r=Math.min(r,d),t=Math.max(t,d)}let s=(r+t)/2;const c=1.11;if(s=Math.min(255,s*c),t-r<=24&&(s=r/2,e>0&&o>0)){const t=(m.get(o,e-1)+2*m.get(o-1,e)+m.get(o-1,e-1))/4;r<t&&(s=t)}m.set(o,e,s)}let C;if(c){const r=new Uint8ClampedArray(e.buffer,l,d);l+=d,C=new BitMatrix(r,o)}else C=BitMatrix.createEmpty(o,r);let w=null;if(t)if(c){const r=new Uint8ClampedArray(e.buffer,l,d);w=new BitMatrix(r,o)}else w=BitMatrix.createEmpty(o,r);for(let e=0;e<B;e++)for(let o=0;o<i;o++){const r=numBetween(o,2,i-3),s=numBetween(e,2,B-3);let c=0;for(let e=-2;e<=2;e++)for(let o=-2;o<=2;o++)c+=m.get(r+e,s+o);const d=c/25;for(let r=0;r<8;r++)for(let s=0;s<8;s++){const c=8*o+r,n=8*e+s,l=a.get(c,n);C.set(c,n,l<=d),t&&w.set(c,n,!(l<=d))}}return t?{binarized:C,inverted:w}:{binarized:C}}class BitStream{constructor(e){this.byteOffset=0,this.bitOffset=0,this.bytes=e}readBits(e){if(e<1||e>32||e>this.available())throw new Error("Cannot read "+e.toString()+" bits");let o=0;if(this.bitOffset>0){const r=8-this.bitOffset,t=e<r?e:r,s=r-t,c=255>>8-t<<s;o=(this.bytes[this.byteOffset]&c)>>s,e-=t,this.bitOffset+=t,8===this.bitOffset&&(this.bitOffset=0,this.byteOffset++)}if(e>0){for(;e>=8;)o=o<<8|255&this.bytes[this.byteOffset],this.byteOffset++,e-=8;if(e>0){const r=8-e,t=255>>r<<r;o=o<<e|(this.bytes[this.byteOffset]&t)>>r,this.bitOffset+=e}}return o}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Mode,ModeByte;function decodeNumeric(e,o){const r=[];let t="";const s=[10,12,14][o];let c=e.readBits(s);for(;c>=3;){const o=e.readBits(10);if(o>=1e3)throw new Error("Invalid numeric value above 999");const s=Math.floor(o/100),d=Math.floor(o/10)%10,n=o%10;r.push(48+s,48+d,48+n),t+=s.toString()+d.toString()+n.toString(),c-=3}if(2===c){const o=e.readBits(7);if(o>=100)throw new Error("Invalid numeric value above 99");const s=Math.floor(o/10),c=o%10;r.push(48+s,48+c),t+=s.toString()+c.toString()}else if(1===c){const o=e.readBits(4);if(o>=10)throw new Error("Invalid numeric value above 9");r.push(48+o),t+=o.toString()}return{bytes:r,text:t}}!function(e){e.Numeric="numeric",e.Alphanumeric="alphanumeric",e.Byte="byte",e.Kanji="kanji",e.ECI="eci",e.StructuredAppend="structuredappend"}(Mode||(Mode={})),function(e){e[e.Terminator=0]="Terminator",e[e.Numeric=1]="Numeric",e[e.Alphanumeric=2]="Alphanumeric",e[e.Byte=4]="Byte",e[e.Kanji=8]="Kanji",e[e.ECI=7]="ECI",e[e.StructuredAppend=3]="StructuredAppend"}(ModeByte||(ModeByte={}));const AlphanumericCharacterCodes=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function decodeAlphanumeric(e,o){const r=[];let t="";const s=[9,11,13][o];let c=e.readBits(s);for(;c>=2;){const o=e.readBits(11),s=Math.floor(o/45),d=o%45;r.push(AlphanumericCharacterCodes[s].charCodeAt(0),AlphanumericCharacterCodes[d].charCodeAt(0)),t+=AlphanumericCharacterCodes[s]+AlphanumericCharacterCodes[d],c-=2}if(1===c){const o=e.readBits(6);r.push(AlphanumericCharacterCodes[o].charCodeAt(0)),t+=AlphanumericCharacterCodes[o]}return{bytes:r,text:t}}function decodeByte(e,o){const r=[];let t="";const s=[8,16,16][o],c=e.readBits(s);for(let o=0;o<c;o++){const o=e.readBits(8);r.push(o)}try{t+=decodeURIComponent(r.map((e=>`%${("0"+e.toString(16)).substr(-2)}`)).join(""))}catch(e){}return{bytes:r,text:t}}function decodeKanji(e,o){const r=[],t=[8,10,12][o],s=e.readBits(t);for(let o=0;o<s;o++){const o=e.readBits(13);let t=Math.floor(o/192)<<8|o%192;t+=t<7936?33088:49472,r.push(t>>8,255&t)}return{bytes:r,text:new TextDecoder("shift-jis").decode(Uint8Array.from(r))}}function decode$2(e,o){const r=new BitStream(e),t=o<=9?0:o<=26?1:2,s={text:"",bytes:[],chunks:[],version:o};for(;r.available()>=4;){const e=r.readBits(4);if(e===ModeByte.Terminator)return s;if(e===ModeByte.ECI)0===r.readBits(1)?s.chunks.push({type:Mode.ECI,assignmentNumber:r.readBits(7)}):0===r.readBits(1)?s.chunks.push({type:Mode.ECI,assignmentNumber:r.readBits(14)}):0===r.readBits(1)?s.chunks.push({type:Mode.ECI,assignmentNumber:r.readBits(21)}):s.chunks.push({type:Mode.ECI,assignmentNumber:-1});else if(e===ModeByte.Numeric){const e=decodeNumeric(r,t);s.text+=e.text,s.bytes.push(...e.bytes),s.chunks.push({type:Mode.Numeric,text:e.text})}else if(e===ModeByte.Alphanumeric){const e=decodeAlphanumeric(r,t);s.text+=e.text,s.bytes.push(...e.bytes),s.chunks.push({type:Mode.Alphanumeric,text:e.text})}else if(e===ModeByte.Byte){const e=decodeByte(r,t);s.text+=e.text,s.bytes.push(...e.bytes),s.chunks.push({type:Mode.Byte,bytes:e.bytes,text:e.text})}else if(e===ModeByte.Kanji){const e=decodeKanji(r,t);s.text+=e.text,s.bytes.push(...e.bytes),s.chunks.push({type:Mode.Kanji,bytes:e.bytes,text:e.text})}else e===ModeByte.StructuredAppend&&s.chunks.push({type:Mode.StructuredAppend,currentSequence:r.readBits(4),totalSequence:r.readBits(4),parity:r.readBits(8)})}if(0===r.available()||0===r.readBits(r.available()))return s}class GenericGFPoly{constructor(e,o){if(0===o.length)throw new Error("No coefficients.");this.field=e;const r=o.length;if(r>1&&0===o[0]){let t=1;for(;t<r&&0===o[t];)t++;if(t===r)this.coefficients=e.zero.coefficients;else{this.coefficients=new Uint8ClampedArray(r-t);for(let e=0;e<this.coefficients.length;e++)this.coefficients[e]=o[t+e]}}else this.coefficients=o}degree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}addOrSubtract(e){if(this.isZero())return e;if(e.isZero())return this;let o=this.coefficients,r=e.coefficients;o.length>r.length&&([o,r]=[r,o]);const t=new Uint8ClampedArray(r.length),s=r.length-o.length;for(let e=0;e<s;e++)t[e]=r[e];for(let e=s;e<r.length;e++)t[e]=addOrSubtractGF(o[e-s],r[e]);return new GenericGFPoly(this.field,t)}multiply(e){if(0===e)return this.field.zero;if(1===e)return this;const o=this.coefficients.length,r=new Uint8ClampedArray(o);for(let t=0;t<o;t++)r[t]=this.field.multiply(this.coefficients[t],e);return new GenericGFPoly(this.field,r)}multiplyPoly(e){if(this.isZero()||e.isZero())return this.field.zero;const o=this.coefficients,r=o.length,t=e.coefficients,s=t.length,c=new Uint8ClampedArray(r+s-1);for(let e=0;e<r;e++){const r=o[e];for(let o=0;o<s;o++)c[e+o]=addOrSubtractGF(c[e+o],this.field.multiply(r,t[o]))}return new GenericGFPoly(this.field,c)}multiplyByMonomial(e,o){if(e<0)throw new Error("Invalid degree less than 0");if(0===o)return this.field.zero;const r=this.coefficients.length,t=new Uint8ClampedArray(r+e);for(let e=0;e<r;e++)t[e]=this.field.multiply(this.coefficients[e],o);return new GenericGFPoly(this.field,t)}evaluateAt(e){let o=0;if(0===e)return this.getCoefficient(0);const r=this.coefficients.length;if(1===e)return this.coefficients.forEach((e=>{o=addOrSubtractGF(o,e)})),o;o=this.coefficients[0];for(let t=1;t<r;t++)o=addOrSubtractGF(this.field.multiply(e,o),this.coefficients[t]);return o}}function addOrSubtractGF(e,o){return e^o}class GenericGF{constructor(e,o,r){this.primitive=e,this.size=o,this.generatorBase=r,this.expTable=new Array(this.size),this.logTable=new Array(this.size);let t=1;for(let e=0;e<this.size;e++)this.expTable[e]=t,t*=2,t>=this.size&&(t=(t^this.primitive)&this.size-1);for(let e=0;e<this.size-1;e++)this.logTable[this.expTable[e]]=e;this.zero=new GenericGFPoly(this,Uint8ClampedArray.from([0])),this.one=new GenericGFPoly(this,Uint8ClampedArray.from([1]))}multiply(e,o){return 0===e||0===o?0:this.expTable[(this.logTable[e]+this.logTable[o])%(this.size-1)]}inverse(e){if(0===e)throw new Error("Can't invert 0");return this.expTable[this.size-this.logTable[e]-1]}buildMonomial(e,o){if(e<0)throw new Error("Invalid monomial degree less than 0");if(0===o)return this.zero;const r=new Uint8ClampedArray(e+1);return r[0]=o,new GenericGFPoly(this,r)}log(e){if(0===e)throw new Error("Can't take log(0)");return this.logTable[e]}exp(e){return this.expTable[e]}}function runEuclideanAlgorithm(e,o,r,t){o.degree()<r.degree()&&([o,r]=[r,o]);let s=o,c=r,d=e.zero,n=e.one;for(;c.degree()>=t/2;){const o=s,r=d;if(s=c,d=n,s.isZero())return null;c=o;let t=e.zero;const l=s.getCoefficient(s.degree()),a=e.inverse(l);for(;c.degree()>=s.degree()&&!c.isZero();){const o=c.degree()-s.degree(),r=e.multiply(c.getCoefficient(c.degree()),a);t=t.addOrSubtract(e.buildMonomial(o,r)),c=c.addOrSubtract(s.multiplyByMonomial(o,r))}if(n=t.multiplyPoly(d).addOrSubtract(r),c.degree()>=s.degree())return null}const l=n.getCoefficient(0);if(0===l)return null;const a=e.inverse(l);return[n.multiply(a),c.multiply(a)]}function findErrorLocations(e,o){const r=o.degree();if(1===r)return[o.getCoefficient(1)];const t=new Array(r);let s=0;for(let c=1;c<e.size&&s<r;c++)0===o.evaluateAt(c)&&(t[s]=e.inverse(c),s++);return s!==r?null:t}function findErrorMagnitudes(e,o,r){const t=r.length,s=new Array(t);for(let c=0;c<t;c++){const d=e.inverse(r[c]);let n=1;for(let o=0;o<t;o++)c!==o&&(n=e.multiply(n,addOrSubtractGF(1,e.multiply(r[o],d))));s[c]=e.multiply(o.evaluateAt(d),e.inverse(n)),0!==e.generatorBase&&(s[c]=e.multiply(s[c],d))}return s}function decode$1(e,o){const r=new Uint8ClampedArray(e.length);r.set(e);const t=new GenericGF(285,256,0),s=new GenericGFPoly(t,r),c=new Uint8ClampedArray(o);let d=!1;for(let e=0;e<o;e++){const o=s.evaluateAt(t.exp(e+t.generatorBase));c[c.length-1-e]=o,0!==o&&(d=!0)}if(!d)return r;const n=new GenericGFPoly(t,c),l=runEuclideanAlgorithm(t,t.buildMonomial(o,1),n,o);if(null===l)return null;const a=findErrorLocations(t,l[0]);if(null==a)return null;const i=findErrorMagnitudes(t,l[1],a);for(let e=0;e<a.length;e++){const o=r.length-1-t.log(a[e]);if(o<0)return null;r[o]=addOrSubtractGF(r[o],i[e])}return r}const VERSIONS=[{infoBits:null,versionNumber:1,alignmentPatternCenters:[],errorCorrectionLevels:[{ecCodewordsPerBlock:7,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:13,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:13}]},{ecCodewordsPerBlock:17,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:2,alignmentPatternCenters:[6,18],errorCorrectionLevels:[{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:34}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:28}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]}]},{infoBits:null,versionNumber:3,alignmentPatternCenters:[6,22],errorCorrectionLevels:[{ecCodewordsPerBlock:15,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:55}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:13}]}]},{infoBits:null,versionNumber:4,alignmentPatternCenters:[6,26],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:80}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:32}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:5,alignmentPatternCenters:[6,30],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:43}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:11},{numBlocks:2,dataCodewordsPerBlock:12}]}]},{infoBits:null,versionNumber:6,alignmentPatternCenters:[6,34],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:27}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:31892,versionNumber:7,alignmentPatternCenters:[6,22,38],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:78}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:31}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:13},{numBlocks:1,dataCodewordsPerBlock:14}]}]},{infoBits:34236,versionNumber:8,alignmentPatternCenters:[6,24,42],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:97}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:38},{numBlocks:2,dataCodewordsPerBlock:39}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:18},{numBlocks:2,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:14},{numBlocks:2,dataCodewordsPerBlock:15}]}]},{infoBits:39577,versionNumber:9,alignmentPatternCenters:[6,26,46],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:12},{numBlocks:4,dataCodewordsPerBlock:13}]}]},{infoBits:42195,versionNumber:10,alignmentPatternCenters:[6,28,50],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68},{numBlocks:2,dataCodewordsPerBlock:69}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:43},{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]}]},{infoBits:48118,versionNumber:11,alignmentPatternCenters:[6,30,54],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:81}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:50},{numBlocks:4,dataCodewordsPerBlock:51}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:22},{numBlocks:4,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:12},{numBlocks:8,dataCodewordsPerBlock:13}]}]},{infoBits:51042,versionNumber:12,alignmentPatternCenters:[6,32,58],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:92},{numBlocks:2,dataCodewordsPerBlock:93}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:20},{numBlocks:6,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:55367,versionNumber:13,alignmentPatternCenters:[6,34,62],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:37},{numBlocks:1,dataCodewordsPerBlock:38}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:20},{numBlocks:4,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:11},{numBlocks:4,dataCodewordsPerBlock:12}]}]},{infoBits:58893,versionNumber:14,alignmentPatternCenters:[6,26,46,66],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:40},{numBlocks:5,dataCodewordsPerBlock:41}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:16},{numBlocks:5,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:5,dataCodewordsPerBlock:13}]}]},{infoBits:63784,versionNumber:15,alignmentPatternCenters:[6,26,48,70],errorCorrectionLevels:[{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:87},{numBlocks:1,dataCodewordsPerBlock:88}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:41},{numBlocks:5,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:7,dataCodewordsPerBlock:13}]}]},{infoBits:68472,versionNumber:16,alignmentPatternCenters:[6,26,50,74],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:98},{numBlocks:1,dataCodewordsPerBlock:99}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:70749,versionNumber:17,alignmentPatternCenters:[6,30,54,78],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:1,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22},{numBlocks:15,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:17,dataCodewordsPerBlock:15}]}]},{infoBits:76311,versionNumber:18,alignmentPatternCenters:[6,30,56,82],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:120},{numBlocks:1,dataCodewordsPerBlock:121}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:43},{numBlocks:4,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:1,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:19,dataCodewordsPerBlock:15}]}]},{infoBits:79154,versionNumber:19,alignmentPatternCenters:[6,30,58,86],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:113},{numBlocks:4,dataCodewordsPerBlock:114}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:44},{numBlocks:11,dataCodewordsPerBlock:45}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:21},{numBlocks:4,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:13},{numBlocks:16,dataCodewordsPerBlock:14}]}]},{infoBits:84390,versionNumber:20,alignmentPatternCenters:[6,34,62,90],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:41},{numBlocks:13,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:5,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:15},{numBlocks:10,dataCodewordsPerBlock:16}]}]},{infoBits:87683,versionNumber:21,alignmentPatternCenters:[6,28,50,72,94],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:116},{numBlocks:4,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:16},{numBlocks:6,dataCodewordsPerBlock:17}]}]},{infoBits:92361,versionNumber:22,alignmentPatternCenters:[6,26,50,74,98],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:111},{numBlocks:7,dataCodewordsPerBlock:112}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:13}]}]},{infoBits:96236,versionNumber:23,alignmentPatternCenters:[6,30,54,74,102],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:121},{numBlocks:5,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:47},{numBlocks:14,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:16,dataCodewordsPerBlock:15},{numBlocks:14,dataCodewordsPerBlock:16}]}]},{infoBits:102084,versionNumber:24,alignmentPatternCenters:[6,28,54,80,106],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:45},{numBlocks:14,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:30,dataCodewordsPerBlock:16},{numBlocks:2,dataCodewordsPerBlock:17}]}]},{infoBits:102881,versionNumber:25,alignmentPatternCenters:[6,32,58,84,110],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:106},{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:47},{numBlocks:13,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:110507,versionNumber:26,alignmentPatternCenters:[6,30,58,86,114],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:114},{numBlocks:2,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:46},{numBlocks:4,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:28,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:33,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]}]},{infoBits:110734,versionNumber:27,alignmentPatternCenters:[6,34,62,90,118],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:23},{numBlocks:26,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:117786,versionNumber:28,alignmentPatternCenters:[6,26,50,74,98,122],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:117},{numBlocks:10,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:45},{numBlocks:23,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:24},{numBlocks:31,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:31,dataCodewordsPerBlock:16}]}]},{infoBits:119615,versionNumber:29,alignmentPatternCenters:[6,30,54,78,102,126],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:116},{numBlocks:7,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:21,dataCodewordsPerBlock:45},{numBlocks:7,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:23},{numBlocks:37,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:26,dataCodewordsPerBlock:16}]}]},{infoBits:126325,versionNumber:30,alignmentPatternCenters:[6,26,52,78,104,130],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:115},{numBlocks:10,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:47},{numBlocks:10,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:25,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:25,dataCodewordsPerBlock:16}]}]},{infoBits:127568,versionNumber:31,alignmentPatternCenters:[6,30,56,82,108,134],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:3,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:46},{numBlocks:29,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:24},{numBlocks:1,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:133589,versionNumber:32,alignmentPatternCenters:[6,34,60,86,112,138],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:24},{numBlocks:35,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:35,dataCodewordsPerBlock:16}]}]},{infoBits:136944,versionNumber:33,alignmentPatternCenters:[6,30,58,86,114,142],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:21,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:24},{numBlocks:19,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:141498,versionNumber:34,alignmentPatternCenters:[6,34,62,90,118,146],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:6,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:44,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:59,dataCodewordsPerBlock:16},{numBlocks:1,dataCodewordsPerBlock:17}]}]},{infoBits:145311,versionNumber:35,alignmentPatternCenters:[6,30,54,78,102,126,150],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:121},{numBlocks:7,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:47},{numBlocks:26,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:39,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:41,dataCodewordsPerBlock:16}]}]},{infoBits:150283,versionNumber:36,alignmentPatternCenters:[6,24,50,76,102,128,154],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:121},{numBlocks:14,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:47},{numBlocks:34,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:46,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:64,dataCodewordsPerBlock:16}]}]},{infoBits:152622,versionNumber:37,alignmentPatternCenters:[6,28,54,80,106,132,158],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:46},{numBlocks:14,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:49,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:24,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:158308,versionNumber:38,alignmentPatternCenters:[6,32,58,84,110,136,162],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:122},{numBlocks:18,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:46},{numBlocks:32,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:48,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:15},{numBlocks:32,dataCodewordsPerBlock:16}]}]},{infoBits:161089,versionNumber:39,alignmentPatternCenters:[6,26,54,82,110,138,166],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:40,dataCodewordsPerBlock:47},{numBlocks:7,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:43,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:15},{numBlocks:67,dataCodewordsPerBlock:16}]}]},{infoBits:167017,versionNumber:40,alignmentPatternCenters:[6,30,58,86,114,142,170],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:118},{numBlocks:6,dataCodewordsPerBlock:119}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:18,dataCodewordsPerBlock:47},{numBlocks:31,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:24},{numBlocks:34,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:15},{numBlocks:61,dataCodewordsPerBlock:16}]}]}];function numBitsDiffering(e,o){let r=e^o,t=0;for(;r;)t++,r&=r-1;return t}function pushBit(e,o){return o<<1|e}const FORMAT_INFO_TABLE=[{bits:21522,formatInfo:{errorCorrectionLevel:1,dataMask:0}},{bits:20773,formatInfo:{errorCorrectionLevel:1,dataMask:1}},{bits:24188,formatInfo:{errorCorrectionLevel:1,dataMask:2}},{bits:23371,formatInfo:{errorCorrectionLevel:1,dataMask:3}},{bits:17913,formatInfo:{errorCorrectionLevel:1,dataMask:4}},{bits:16590,formatInfo:{errorCorrectionLevel:1,dataMask:5}},{bits:20375,formatInfo:{errorCorrectionLevel:1,dataMask:6}},{bits:19104,formatInfo:{errorCorrectionLevel:1,dataMask:7}},{bits:30660,formatInfo:{errorCorrectionLevel:0,dataMask:0}},{bits:29427,formatInfo:{errorCorrectionLevel:0,dataMask:1}},{bits:32170,formatInfo:{errorCorrectionLevel:0,dataMask:2}},{bits:30877,formatInfo:{errorCorrectionLevel:0,dataMask:3}},{bits:26159,formatInfo:{errorCorrectionLevel:0,dataMask:4}},{bits:25368,formatInfo:{errorCorrectionLevel:0,dataMask:5}},{bits:27713,formatInfo:{errorCorrectionLevel:0,dataMask:6}},{bits:26998,formatInfo:{errorCorrectionLevel:0,dataMask:7}},{bits:5769,formatInfo:{errorCorrectionLevel:3,dataMask:0}},{bits:5054,formatInfo:{errorCorrectionLevel:3,dataMask:1}},{bits:7399,formatInfo:{errorCorrectionLevel:3,dataMask:2}},{bits:6608,formatInfo:{errorCorrectionLevel:3,dataMask:3}},{bits:1890,formatInfo:{errorCorrectionLevel:3,dataMask:4}},{bits:597,formatInfo:{errorCorrectionLevel:3,dataMask:5}},{bits:3340,formatInfo:{errorCorrectionLevel:3,dataMask:6}},{bits:2107,formatInfo:{errorCorrectionLevel:3,dataMask:7}},{bits:13663,formatInfo:{errorCorrectionLevel:2,dataMask:0}},{bits:12392,formatInfo:{errorCorrectionLevel:2,dataMask:1}},{bits:16177,formatInfo:{errorCorrectionLevel:2,dataMask:2}},{bits:14854,formatInfo:{errorCorrectionLevel:2,dataMask:3}},{bits:9396,formatInfo:{errorCorrectionLevel:2,dataMask:4}},{bits:8579,formatInfo:{errorCorrectionLevel:2,dataMask:5}},{bits:11994,formatInfo:{errorCorrectionLevel:2,dataMask:6}},{bits:11245,formatInfo:{errorCorrectionLevel:2,dataMask:7}}],DATA_MASKS=[e=>(e.y+e.x)%2==0,e=>e.y%2==0,e=>e.x%3==0,e=>(e.y+e.x)%3==0,e=>(Math.floor(e.y/2)+Math.floor(e.x/3))%2==0,e=>e.x*e.y%2+e.x*e.y%3==0,e=>(e.y*e.x%2+e.y*e.x%3)%2==0,e=>((e.y+e.x)%2+e.y*e.x%3)%2==0];function buildFunctionPatternMask(e){const o=17+4*e.versionNumber,r=BitMatrix.createEmpty(o,o);r.setRegion(0,0,9,9,!0),r.setRegion(o-8,0,8,9,!0),r.setRegion(0,o-8,9,8,!0);for(const t of e.alignmentPatternCenters)for(const s of e.alignmentPatternCenters)6===t&&6===s||6===t&&s===o-7||t===o-7&&6===s||r.setRegion(t-2,s-2,5,5,!0);return r.setRegion(6,9,1,o-17,!0),r.setRegion(9,6,o-17,1,!0),e.versionNumber>6&&(r.setRegion(o-11,0,3,6,!0),r.setRegion(0,o-11,6,3,!0)),r}function readCodewords(e,o,r){const t=DATA_MASKS[r.dataMask],s=e.height,c=buildFunctionPatternMask(o),d=[];let n=0,l=0,a=!0;for(let o=s-1;o>0;o-=2){6===o&&o--;for(let r=0;r<s;r++){const i=a?s-1-r:r;for(let r=0;r<2;r++){const s=o-r;if(!c.get(s,i)){l++;let o=e.get(s,i);t({y:i,x:s})&&(o=!o),n=pushBit(o,n),8===l&&(d.push(n),l=0,n=0)}}}a=!a}return d}function readVersion(e){const o=e.height,r=Math.floor((o-17)/4);if(r<=6)return VERSIONS[r-1];let t=0;for(let r=5;r>=0;r--)for(let s=o-9;s>=o-11;s--)t=pushBit(e.get(s,r),t);let s=0;for(let r=5;r>=0;r--)for(let t=o-9;t>=o-11;t--)s=pushBit(e.get(r,t),s);let c,d=1/0;for(const e of VERSIONS){if(e.infoBits===t||e.infoBits===s)return e;let o=numBitsDiffering(t,e.infoBits);o<d&&(c=e,d=o),o=numBitsDiffering(s,e.infoBits),o<d&&(c=e,d=o)}return d<=3?c:void 0}function readFormatInformation(e){let o=0;for(let r=0;r<=8;r++)6!==r&&(o=pushBit(e.get(r,8),o));for(let r=7;r>=0;r--)6!==r&&(o=pushBit(e.get(8,r),o));const r=e.height;let t=0;for(let o=r-1;o>=r-7;o--)t=pushBit(e.get(8,o),t);for(let o=r-8;o<r;o++)t=pushBit(e.get(o,8),t);let s=1/0,c=null;for(const{bits:e,formatInfo:r}of FORMAT_INFO_TABLE){if(e===o||e===t)return r;let d=numBitsDiffering(o,e);d<s&&(c=r,s=d),o!==t&&(d=numBitsDiffering(t,e),d<s&&(c=r,s=d))}return s<=3?c:null}function getDataBlocks(e,o,r){const t=o.errorCorrectionLevels[r],s=[];let c=0;if(t.ecBlocks.forEach((e=>{for(let o=0;o<e.numBlocks;o++)s.push({numDataCodewords:e.dataCodewordsPerBlock,codewords:[]}),c+=e.dataCodewordsPerBlock+t.ecCodewordsPerBlock})),e.length<c)return null;e=e.slice(0,c);const d=t.ecBlocks[0].dataCodewordsPerBlock;for(let o=0;o<d;o++)for(const o of s)o.codewords.push(e.shift());if(t.ecBlocks.length>1){const o=t.ecBlocks[0].numBlocks,r=t.ecBlocks[1].numBlocks;for(let t=0;t<r;t++)s[o+t].codewords.push(e.shift())}for(;e.length>0;)for(const o of s)o.codewords.push(e.shift());return s}function decodeMatrix(e){const o=readVersion(e);if(!o)return null;const r=readFormatInformation(e);if(!r)return null;const t=getDataBlocks(readCodewords(e,o,r),o,r.errorCorrectionLevel);if(!t)return null;const s=t.reduce(((e,o)=>e+o.numDataCodewords),0),c=new Uint8ClampedArray(s);let d=0;for(const e of t){const o=decode$1(e.codewords,e.codewords.length-e.numDataCodewords);if(!o)return null;for(let r=0;r<e.numDataCodewords;r++)c[d++]=o[r]}try{return decode$2(c,o.versionNumber)}catch(e){return null}}function decode(e){if(null==e)return null;const o=decodeMatrix(e);if(o)return o;for(let o=0;o<e.width;o++)for(let r=o+1;r<e.height;r++)e.get(o,r)!==e.get(r,o)&&(e.set(o,r,!e.get(o,r)),e.set(r,o,!e.get(r,o)));return decodeMatrix(e)}function squareToQuadrilateral(e,o,r,t){const s=e.x-o.x+r.x-t.x,c=e.y-o.y+r.y-t.y;if(0===s&&0===c)return{a11:o.x-e.x,a12:o.y-e.y,a13:0,a21:r.x-o.x,a22:r.y-o.y,a23:0,a31:e.x,a32:e.y,a33:1};{const d=o.x-r.x,n=t.x-r.x,l=o.y-r.y,a=t.y-r.y,i=d*a-n*l,B=(s*a-n*c)/i,k=(d*c-s*l)/i;return{a11:o.x-e.x+B*o.x,a12:o.y-e.y+B*o.y,a13:B,a21:t.x-e.x+k*t.x,a22:t.y-e.y+k*t.y,a23:k,a31:e.x,a32:e.y,a33:1}}}function quadrilateralToSquare(e,o,r,t){const s=squareToQuadrilateral(e,o,r,t);return{a11:s.a22*s.a33-s.a23*s.a32,a12:s.a13*s.a32-s.a12*s.a33,a13:s.a12*s.a23-s.a13*s.a22,a21:s.a23*s.a31-s.a21*s.a33,a22:s.a11*s.a33-s.a13*s.a31,a23:s.a13*s.a21-s.a11*s.a23,a31:s.a21*s.a32-s.a22*s.a31,a32:s.a12*s.a31-s.a11*s.a32,a33:s.a11*s.a22-s.a12*s.a21}}function times(e,o){return{a11:e.a11*o.a11+e.a21*o.a12+e.a31*o.a13,a12:e.a12*o.a11+e.a22*o.a12+e.a32*o.a13,a13:e.a13*o.a11+e.a23*o.a12+e.a33*o.a13,a21:e.a11*o.a21+e.a21*o.a22+e.a31*o.a23,a22:e.a12*o.a21+e.a22*o.a22+e.a32*o.a23,a23:e.a13*o.a21+e.a23*o.a22+e.a33*o.a23,a31:e.a11*o.a31+e.a21*o.a32+e.a31*o.a33,a32:e.a12*o.a31+e.a22*o.a32+e.a32*o.a33,a33:e.a13*o.a31+e.a23*o.a32+e.a33*o.a33}}function extract(e,o){const r=quadrilateralToSquare({x:3.5,y:3.5},{x:o.dimension-3.5,y:3.5},{x:o.dimension-6.5,y:o.dimension-6.5},{x:3.5,y:o.dimension-3.5}),t=times(squareToQuadrilateral(o.topLeft,o.topRight,o.alignmentPattern,o.bottomLeft),r),s=BitMatrix.createEmpty(o.dimension,o.dimension),c=(e,o)=>{const r=t.a13*e+t.a23*o+t.a33;return{x:(t.a11*e+t.a21*o+t.a31)/r,y:(t.a12*e+t.a22*o+t.a32)/r}};for(let r=0;r<o.dimension;r++)for(let t=0;t<o.dimension;t++){const o=c(t+.5,r+.5);s.set(t,r,e.get(Math.floor(o.x),Math.floor(o.y)))}return{matrix:s,mappingFunction:c}}const MAX_FINDERPATTERNS_TO_SEARCH=5,MIN_QUAD_RATIO=.5,MAX_QUAD_RATIO=1.5,distance=(e,o)=>Math.sqrt(Math.pow(o.x-e.x,2)+Math.pow(o.y-e.y,2));function sum(e){return e.reduce(((e,o)=>e+o))}function reorderFinderPatterns(e,o,r){const t=distance(e,o),s=distance(o,r),c=distance(e,r);let d,n,l;return[d,n,l]=s>=t&&s>=c?[o,e,r]:c>=s&&c>=t?[e,o,r]:[e,r,o],(l.x-n.x)*(d.y-n.y)-(l.y-n.y)*(d.x-n.x)<0&&([d,l]=[l,d]),{bottomLeft:d,topLeft:n,topRight:l}}function computeDimension(e,o,r,t){const s=(sum(countBlackWhiteRun(e,r,t,5))/7+sum(countBlackWhiteRun(e,o,t,5))/7+sum(countBlackWhiteRun(r,e,t,5))/7+sum(countBlackWhiteRun(o,e,t,5))/7)/4;if(s<1)throw new Error("Invalid module size");const c=Math.round(distance(e,o)/s),d=Math.round(distance(e,r)/s);let n=Math.floor((c+d)/2)+7;switch(n%4){case 0:n++;break;case 2:n--}return{dimension:n,moduleSize:s}}function countBlackWhiteRunTowardsPoint(e,o,r,t){const s=[{x:Math.floor(e.x),y:Math.floor(e.y)}],c=Math.abs(o.y-e.y)>Math.abs(o.x-e.x);let d,n,l,a;c?(d=Math.floor(e.y),n=Math.floor(e.x),l=Math.floor(o.y),a=Math.floor(o.x)):(d=Math.floor(e.x),n=Math.floor(e.y),l=Math.floor(o.x),a=Math.floor(o.y));const i=Math.abs(l-d),B=Math.abs(a-n);let k=Math.floor(-i/2);const u=d<l?1:-1,m=n<a?1:-1;let C=!0;for(let e=d,o=n;e!==l+u;e+=u){const d=c?o:e,n=c?e:o;if(r.get(d,n)!==C&&(C=!C,s.push({x:d,y:n}),s.length===t+1))break;if(k+=B,k>0){if(o===a)break;o+=m,k-=i}}const w=[];for(let e=0;e<t;e++)s[e]&&s[e+1]?w.push(distance(s[e],s[e+1])):w.push(0);return w}function countBlackWhiteRun(e,o,r,t){const s=o.y-e.y,c=o.x-e.x,d=countBlackWhiteRunTowardsPoint(e,o,r,Math.ceil(t/2)),n=countBlackWhiteRunTowardsPoint(e,{x:e.x-c,y:e.y-s},r,Math.ceil(t/2)),l=d.shift()+n.shift()-1;return n.concat(l).concat(...d)}function scoreBlackWhiteRun(e,o){const r=sum(e)/sum(o);let t=0;return o.forEach(((o,s)=>{t+=Math.pow(e[s]-o*r,2)})),{averageSize:r,error:t}}function scorePattern(e,o,r){try{const t=countBlackWhiteRun(e,{x:-1,y:e.y},r,o.length),s=countBlackWhiteRun(e,{x:e.x,y:-1},r,o.length),c=countBlackWhiteRun(e,{x:Math.max(0,e.x-e.y)-1,y:Math.max(0,e.y-e.x)-1},r,o.length),d=countBlackWhiteRun(e,{x:Math.min(r.width,e.x+e.y)+1,y:Math.min(r.height,e.y+e.x)+1},r,o.length),n=scoreBlackWhiteRun(t,o),l=scoreBlackWhiteRun(s,o),a=scoreBlackWhiteRun(c,o),i=scoreBlackWhiteRun(d,o),B=Math.sqrt(n.error*n.error+l.error*l.error+a.error*a.error+i.error*i.error),k=(n.averageSize+l.averageSize+a.averageSize+i.averageSize)/4;return B+(Math.pow(n.averageSize-k,2)+Math.pow(l.averageSize-k,2)+Math.pow(a.averageSize-k,2)+Math.pow(i.averageSize-k,2))/k}catch(e){return 1/0}}function recenterLocation(e,o){let r=Math.round(o.x);for(;e.get(r,Math.round(o.y));)r--;let t=Math.round(o.x);for(;e.get(t,Math.round(o.y));)t++;const s=(r+t)/2;let c=Math.round(o.y);for(;e.get(Math.round(s),c);)c--;let d=Math.round(o.y);for(;e.get(Math.round(s),d);)d++;return{x:s,y:(c+d)/2}}function locate(e){const o=[];let r=[];const t=[];let s=[];for(let c=0;c<=e.height;c++){let d=0,n=!1,l=[0,0,0,0,0];for(let o=-1;o<=e.width;o++){const t=e.get(o,c);if(t===n)d++;else{l=[l[1],l[2],l[3],l[4],d],d=1,n=t;const e=sum(l)/7,a=Math.abs(l[0]-e)<e&&Math.abs(l[1]-e)<e&&Math.abs(l[2]-3*e)<3*e&&Math.abs(l[3]-e)<e&&Math.abs(l[4]-e)<e&&!t,i=sum(l.slice(-3))/3,B=Math.abs(l[2]-i)<i&&Math.abs(l[3]-i)<i&&Math.abs(l[4]-i)<i&&t;if(a){const e=o-l[3]-l[4],t=e-l[2],s={startX:t,endX:e,y:c},d=r.filter((o=>t>=o.bottom.startX&&t<=o.bottom.endX||e>=o.bottom.startX&&t<=o.bottom.endX||t<=o.bottom.startX&&e>=o.bottom.endX&&l[2]/(o.bottom.endX-o.bottom.startX)<1.5&&l[2]/(o.bottom.endX-o.bottom.startX)>.5));d.length>0?d[0].bottom=s:r.push({top:s,bottom:s})}if(B){const e=o-l[4],r=e-l[3],t={startX:r,y:c,endX:e},d=s.filter((o=>r>=o.bottom.startX&&r<=o.bottom.endX||e>=o.bottom.startX&&r<=o.bottom.endX||r<=o.bottom.startX&&e>=o.bottom.endX&&l[2]/(o.bottom.endX-o.bottom.startX)<1.5&&l[2]/(o.bottom.endX-o.bottom.startX)>.5));d.length>0?d[0].bottom=t:s.push({top:t,bottom:t})}}}o.push(...r.filter((e=>e.bottom.y!==c&&e.bottom.y-e.top.y>=2))),r=r.filter((e=>e.bottom.y===c)),t.push(...s.filter((e=>e.bottom.y!==c))),s=s.filter((e=>e.bottom.y===c))}o.push(...r.filter((e=>e.bottom.y-e.top.y>=2))),t.push(...s);const c=[];for(const r of o){if(r.bottom.y-r.top.y<2)continue;const o=(r.top.startX+r.top.endX+r.bottom.startX+r.bottom.endX)/4,t=(r.top.y+r.bottom.y+1)/2;if(!e.get(Math.round(o),Math.round(t)))continue;const s=[r.top.endX-r.top.startX,r.bottom.endX-r.bottom.startX,r.bottom.y-r.top.y+1],d=sum(s)/s.length,n=scorePattern({x:Math.round(o),y:Math.round(t)},[1,1,3,1,1],e);c.push({score:n,x:o,y:t,size:d})}if(c.length<3)return null;c.sort(((e,o)=>e.score-o.score));const d=[];for(let e=0;e<Math.min(c.length,5);++e){const o=c[e],r=[];for(const e of c)e!==o&&r.push(Object.assign(Object.assign({},e),{score:e.score+Math.pow(e.size-o.size,2)/o.size}));r.sort(((e,o)=>e.score-o.score)),d.push({points:[o,r[0],r[1]],score:o.score+r[0].score+r[1].score})}d.sort(((e,o)=>e.score-o.score));const n=d[0],{topRight:l,topLeft:a,bottomLeft:i}=reorderFinderPatterns(...n.points),B=findAlignmentPattern(e,t,l,a,i),k=[];B&&k.push({alignmentPattern:{x:B.alignmentPattern.x,y:B.alignmentPattern.y},bottomLeft:{x:i.x,y:i.y},dimension:B.dimension,topLeft:{x:a.x,y:a.y},topRight:{x:l.x,y:l.y}});const u=recenterLocation(e,l),m=recenterLocation(e,a),C=recenterLocation(e,i),w=findAlignmentPattern(e,t,u,m,C);return w&&k.push({alignmentPattern:{x:w.alignmentPattern.x,y:w.alignmentPattern.y},bottomLeft:{x:C.x,y:C.y},topLeft:{x:m.x,y:m.y},topRight:{x:u.x,y:u.y},dimension:w.dimension}),0===k.length?null:k}function findAlignmentPattern(e,o,r,t,s){let c,d;try{({dimension:c,moduleSize:d}=computeDimension(t,r,s,e))}catch(e){return null}const n=r.x-t.x+s.x,l=r.y-t.y+s.y,a=(distance(t,s)+distance(t,r))/2/d,i=1-3/a,B={x:t.x+i*(n-t.x),y:t.y+i*(l-t.y)},k=o.map((o=>{const r=(o.top.startX+o.top.endX+o.bottom.startX+o.bottom.endX)/4,t=(o.top.y+o.bottom.y+1)/2;if(!e.get(Math.floor(r),Math.floor(t)))return;return{x:r,y:t,score:scorePattern({x:Math.floor(r),y:Math.floor(t)},[1,1,1],e)+distance({x:r,y:t},B)}})).filter((e=>!!e)).sort(((e,o)=>e.score-o.score));return{alignmentPattern:a>=15&&k.length?k[0]:B,dimension:c}}function scan(e){const o=locate(e);if(!o)return null;for(const r of o){const o=extract(e,r),t=decode(o.matrix);if(t)return{binaryData:t.bytes,data:t.text,chunks:t.chunks,version:t.version,location:{topRightCorner:o.mappingFunction(r.dimension,0),topLeftCorner:o.mappingFunction(0,0),bottomRightCorner:o.mappingFunction(r.dimension,r.dimension),bottomLeftCorner:o.mappingFunction(0,r.dimension),topRightFinderPattern:r.topRight,topLeftFinderPattern:r.topLeft,bottomLeftFinderPattern:r.bottomLeft,bottomRightAlignmentPattern:r.alignmentPattern},matrix:o.matrix}}return null}const defaultOptions={inversionAttempts:"attemptBoth",greyScaleWeights:{red:.2126,green:.7152,blue:.0722,useIntegerApproximation:!1},canOverwriteImage:!0};function mergeObject(e,o){Object.keys(o).forEach((r=>{e[r]=o[r]}))}function jsQR(e,o,r,t={}){const s=Object.create(null);mergeObject(s,defaultOptions),mergeObject(s,t);const c="onlyInvert"===s.inversionAttempts||"invertFirst"===s.inversionAttempts,d="attemptBoth"===s.inversionAttempts||c,{binarized:n,inverted:l}=binarize(e,o,r,d,s.greyScaleWeights,s.canOverwriteImage);let a=scan(c?l:n);return a||"attemptBoth"!==s.inversionAttempts&&"invertFirst"!==s.inversionAttempts||(a=scan(c?n:l)),a}jsQR.default=jsQR,self.onmessage=e=>{let o=jsQR(e.data.data,e.data.width,e.data.height);o&&postMessage(o.data)};